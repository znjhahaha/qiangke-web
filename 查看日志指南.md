# 查看服务器日志指南

## EdgeOne Pages 日志查看方法

### 方法 1：EdgeOne 控制台查看（推荐）

1. **登录腾讯云控制台**
   - 访问：https://console.cloud.tencent.com/
   - 登录你的账号

2. **进入 EdgeOne Pages**
   - 在控制台搜索 "EdgeOne" 或 "边缘安全加速"
   - 点击进入 EdgeOne 控制台
   - 找到 "Pages" 或 "静态网站" 菜单

3. **查看日志**
   - 找到你的项目
   - 点击项目名称进入详情
   - 找到 "日志" 或 "Logs" 菜单
   - 查看实时日志或历史日志

### 方法 2：通过 API 路由查看日志

如果 EdgeOne Pages 支持实时日志，你可以：

1. **访问健康检查接口**
   ```
   https://your-domain.com/api/health
   ```
   这会返回服务器状态信息

2. **创建一个日志查看接口**（临时调试用）
   - 访问 `/api/debug/logs`（如果已创建）
   - 查看最近的错误日志

### 方法 3：浏览器控制台查看

1. **打开浏览器开发者工具**
   - 按 `F12` 或右键选择"检查"
   - 切换到 "Console" 标签

2. **查看前端日志**
   - 前端代码中的 `console.log` 会显示在这里
   - 查看 API 请求的错误信息

3. **查看网络请求**
   - 切换到 "Network" 标签
   - 找到失败的 API 请求（通常是红色的）
   - 点击查看请求详情和响应内容

## 添加调试接口（临时）

为了更方便地查看服务器端日志，可以创建一个调试接口：

### 创建调试接口

在 `app/api/debug/logs/route.ts` 中：

```typescript
import { NextResponse } from 'next/server'

export const dynamic = 'force-dynamic'

export async function GET() {
  // 这里可以返回最近的日志（如果实现了日志存储）
  return NextResponse.json({
    message: '调试接口',
    timestamp: new Date().toISOString(),
    environment: process.env.NODE_ENV
  })
}
```

## 常见日志位置

### 1. Next.js 应用日志
- **开发环境**：终端/命令行窗口
- **生产环境**：EdgeOne Pages 控制台的日志页面

### 2. API 路由日志
- 所有 `console.log` 和 `console.error` 都会输出到服务器日志
- 查看 EdgeOne Pages 控制台的日志

### 3. 浏览器日志
- 前端代码的 `console.log` 在浏览器控制台
- API 请求错误在 Network 标签

## 调试技巧

### 1. 添加更多日志

在代码中添加详细的日志：

```typescript
console.log('🔍 调试信息:', {
  timestamp: new Date().toISOString(),
  data: yourData
})
```

### 2. 检查 API 响应

在浏览器 Network 标签中：
- 查看请求的 URL
- 查看请求头（特别是 Cookie）
- 查看响应状态码
- 查看响应内容

### 3. 测试 API 路由

直接访问 API 路由测试：

```
https://your-domain.com/api/student-info?schoolId=xxx
```

在请求头中添加：
```
x-course-cookie: your-cookie-here
```

## 如果无法查看日志

如果 EdgeOne Pages 不提供日志查看功能，可以：

1. **使用第三方日志服务**
   - 集成 Sentry、LogRocket 等日志服务
   - 将错误发送到外部服务

2. **添加日志存储**
   - 将日志保存到数据库或文件
   - 通过 API 接口查看

3. **使用 Vercel 等平台**
   - Vercel 提供完整的日志查看功能
   - 可以实时查看服务器日志

## 快速诊断步骤

1. **检查浏览器控制台**
   - 查看是否有 JavaScript 错误
   - 查看 API 请求是否成功

2. **检查 Network 标签**
   - 查看 `/api/student-info` 请求
   - 查看请求状态码和响应内容

3. **检查 EdgeOne Pages 日志**
   - 查看服务器端日志
   - 查找错误信息

4. **测试 API 路由**
   - 使用 Postman 或 curl 直接测试
   - 确认 API 路由是否正常工作

## 示例：使用 curl 测试

```bash
curl -X GET "https://your-domain.com/api/student-info?schoolId=xxx" \
  -H "x-course-cookie: your-cookie-here" \
  -v
```

这会显示详细的请求和响应信息。

